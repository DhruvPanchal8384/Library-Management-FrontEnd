<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Library Management System</title>
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.production.min.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Lora:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --primary: #8b4513;
        --primary-dark: #654321;
        --secondary: #d2691e;
        --accent: #cd853f;
        --cream: #fff8dc;
        --warm-white: #faf7f0;
        --text-dark: #2c1810;
        --text-muted: #6b5744;
        --success: #2d5016;
        --error: #8b0000;
        --border: #e5dcc3;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Lora", serif;
        background: linear-gradient(
          135deg,
          var(--warm-white) 0%,
          var(--cream) 100%
        );
        color: var(--text-dark);
        min-height: 100vh;
        line-height: 1.6;
      }

      h1,
      h2,
      h3,
      h4 {
        font-family: "Playfair Display", serif;
        font-weight: 700;
      }

      .app-container {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }

      /* Navigation Bar */
      .navbar {
        background: linear-gradient(
          to right,
          var(--primary-dark),
          var(--primary)
        );
        color: var(--cream);
        padding: 1.2rem 2rem;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        display: flex;
        justify-content: space-between;
        align-items: center;
        animation: slideDown 0.5s ease-out;
      }

      @keyframes slideDown {
        from {
          transform: translateY(-100%);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      .navbar-brand {
        font-size: 1.8rem;
        font-family: "Playfair Display", serif;
        font-weight: 700;
        letter-spacing: 0.5px;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .navbar-brand::before {
        content: "ðŸ“š";
        font-size: 2rem;
      }

      .navbar-menu {
        display: flex;
        gap: 2rem;
        align-items: center;
      }

      .nav-link {
        color: var(--cream);
        text-decoration: none;
        font-size: 1rem;
        padding: 0.5rem 1rem;
        border-radius: 4px;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
      }

      .nav-link::before {
        content: "";
        position: absolute;
        bottom: 0;
        left: 50%;
        width: 0;
        height: 2px;
        background: var(--accent);
        transition: all 0.3s ease;
        transform: translateX(-50%);
      }

      .nav-link:hover::before {
        width: 80%;
      }

      .nav-link:hover {
        color: var(--accent);
      }

      .nav-link.active {
        background: rgba(255, 255, 255, 0.1);
        color: var(--accent);
      }

      .logout-btn {
        background: var(--secondary);
        color: var(--cream);
        border: none;
        padding: 0.6rem 1.5rem;
        border-radius: 6px;
        cursor: pointer;
        font-family: "Lora", serif;
        font-size: 1rem;
        transition: all 0.3s ease;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      }

      .logout-btn:hover {
        background: var(--primary-dark);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      }

      /* Auth Pages */
      .auth-container {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        padding: 2rem;
        position: relative;
        overflow: hidden;
      }

      .auth-container::before {
        content: "";
        position: absolute;
        top: -50%;
        right: -50%;
        width: 100%;
        height: 100%;
        background: radial-gradient(circle, var(--accent) 0%, transparent 70%);
        opacity: 0.1;
        animation: float 20s infinite ease-in-out;
      }

      @keyframes float {
        0%,
        100% {
          transform: translate(0, 0) rotate(0deg);
        }
        50% {
          transform: translate(50px, 50px) rotate(180deg);
        }
      }

      .auth-box {
        background: white;
        padding: 3rem;
        border-radius: 16px;
        box-shadow: 0 20px 60px rgba(139, 69, 19, 0.15);
        max-width: 450px;
        width: 100%;
        position: relative;
        animation: fadeInUp 0.6s ease-out;
        border: 1px solid var(--border);
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .auth-box::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 6px;
        background: linear-gradient(
          to right,
          var(--primary),
          var(--secondary),
          var(--accent)
        );
        border-radius: 16px 16px 0 0;
      }

      .auth-header {
        text-align: center;
        margin-bottom: 2.5rem;
      }

      .auth-title {
        font-size: 2.2rem;
        color: var(--primary-dark);
        margin-bottom: 0.5rem;
        font-weight: 700;
      }

      .auth-subtitle {
        color: var(--text-muted);
        font-size: 1rem;
      }

      .form-group {
        margin-bottom: 1.5rem;
        animation: fadeIn 0.5s ease-out backwards;
      }

      .form-group:nth-child(1) {
        animation-delay: 0.1s;
      }
      .form-group:nth-child(2) {
        animation-delay: 0.2s;
      }
      .form-group:nth-child(3) {
        animation-delay: 0.3s;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateX(-20px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      .form-label {
        display: block;
        margin-bottom: 0.5rem;
        color: var(--text-dark);
        font-weight: 500;
        font-size: 0.95rem;
      }

      .form-input {
        width: 100%;
        padding: 0.9rem 1.2rem;
        border: 2px solid var(--border);
        border-radius: 8px;
        font-size: 1rem;
        font-family: "Lora", serif;
        transition: all 0.3s ease;
        background: var(--warm-white);
      }

      .form-input:focus {
        outline: none;
        border-color: var(--primary);
        background: white;
        box-shadow: 0 0 0 4px rgba(139, 69, 19, 0.1);
      }

      .btn-primary {
        width: 100%;
        padding: 1rem;
        background: linear-gradient(
          135deg,
          var(--primary) 0%,
          var(--secondary) 100%
        );
        color: var(--cream);
        border: none;
        border-radius: 8px;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        font-family: "Playfair Display", serif;
        box-shadow: 0 4px 15px rgba(139, 69, 19, 0.3);
        margin-top: 1rem;
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(139, 69, 19, 0.4);
      }

      .btn-primary:active {
        transform: translateY(0);
      }

      .auth-switch {
        text-align: center;
        margin-top: 1.5rem;
        color: var(--text-muted);
      }

      .auth-switch-link {
        color: var(--primary);
        text-decoration: none;
        font-weight: 600;
        margin-left: 0.3rem;
        transition: color 0.3s ease;
      }

      .auth-switch-link:hover {
        color: var(--secondary);
        text-decoration: underline;
      }

      /* Alert Messages */
      .alert {
        padding: 1rem 1.2rem;
        border-radius: 8px;
        margin-bottom: 1.5rem;
        animation: slideInDown 0.4s ease-out;
        font-size: 0.95rem;
      }

      @keyframes slideInDown {
        from {
          opacity: 0;
          transform: translateY(-20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .alert-error {
        background: #fff0f0;
        color: var(--error);
        border: 1px solid #ffd0d0;
      }

      .alert-success {
        background: #f0fff0;
        color: var(--success);
        border: 1px solid #d0ffd0;
      }

      /* Main Content Area */
      .main-content {
        flex: 1;
        padding: 2rem;
        max-width: 1400px;
        width: 100%;
        margin: 0 auto;
        animation: fadeIn 0.5s ease-out;
      }

      .page-header {
        margin-bottom: 2rem;
        padding-bottom: 1rem;
        border-bottom: 2px solid var(--border);
      }

      .page-title {
        font-size: 2.5rem;
        color: var(--primary-dark);
        margin-bottom: 0.5rem;
      }

      .page-description {
        color: var(--text-muted);
        font-size: 1.1rem;
      }

      /* Loading Spinner */
      .loading-container {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 300px;
      }

      .spinner {
        width: 50px;
        height: 50px;
        border: 4px solid var(--border);
        border-top: 4px solid var(--primary);
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* Dashboard Stats Cards */
      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.5rem;
        margin-bottom: 3rem;
      }

      .stat-card {
        background: white;
        padding: 2rem;
        border-radius: 12px;
        box-shadow: 0 4px 20px rgba(139, 69, 19, 0.1);
        border: 1px solid var(--border);
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
        animation: fadeInUp 0.5s ease-out backwards;
      }

      .stat-card:nth-child(1) {
        animation-delay: 0.1s;
      }
      .stat-card:nth-child(2) {
        animation-delay: 0.2s;
      }
      .stat-card:nth-child(3) {
        animation-delay: 0.3s;
      }
      .stat-card:nth-child(4) {
        animation-delay: 0.4s;
      }

      .stat-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 30px rgba(139, 69, 19, 0.15);
      }

      .stat-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(to right, var(--primary), var(--secondary));
      }

      .stat-icon {
        font-size: 3rem;
        margin-bottom: 1rem;
        display: inline-block;
        animation: bounce 2s infinite;
      }

      @keyframes bounce {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-10px);
        }
      }

      .stat-card:hover .stat-icon {
        animation: none;
        transform: scale(1.1);
        transition: transform 0.3s ease;
      }

      .stat-label {
        color: var(--text-muted);
        font-size: 0.95rem;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 0.5rem;
        font-weight: 500;
      }

      .stat-value {
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--primary-dark);
        font-family: "Playfair Display", serif;
        margin-bottom: 0.5rem;
      }

      .stat-description {
        color: var(--text-muted);
        font-size: 0.9rem;
      }

      .stat-trend {
        display: inline-block;
        padding: 0.25rem 0.75rem;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 600;
        margin-top: 0.5rem;
      }

      .stat-trend.positive {
        background: #e8f5e9;
        color: var(--success);
      }

      .stat-trend.negative {
        background: #ffebee;
        color: var(--error);
      }

      /* Dashboard Sections */
      .dashboard-section {
        background: white;
        padding: 2rem;
        border-radius: 12px;
        box-shadow: 0 4px 20px rgba(139, 69, 19, 0.1);
        border: 1px solid var(--border);
        margin-bottom: 2rem;
        animation: fadeIn 0.6s ease-out;
      }

      .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 2px solid var(--border);
      }

      .section-title {
        font-size: 1.5rem;
        color: var(--primary-dark);
        font-weight: 600;
      }

      .section-link {
        color: var(--primary);
        text-decoration: none;
        font-weight: 500;
        transition: color 0.3s ease;
      }

      .section-link:hover {
        color: var(--secondary);
      }

      /* Recent Activity Table */
      .activity-table {
        width: 100%;
        border-collapse: collapse;
      }

      .activity-table thead {
        background: var(--warm-white);
      }

      .activity-table th {
        padding: 1rem;
        text-align: left;
        font-weight: 600;
        color: var(--text-dark);
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .activity-table td {
        padding: 1rem;
        border-bottom: 1px solid var(--border);
        color: var(--text-dark);
      }

      .activity-table tbody tr {
        transition: background 0.3s ease;
      }

      .activity-table tbody tr:hover {
        background: var(--warm-white);
      }

      .status-badge {
        display: inline-block;
        padding: 0.35rem 0.9rem;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .status-badge.issued {
        background: #fff3e0;
        color: #e65100;
      }

      .status-badge.returned {
        background: #e8f5e9;
        color: var(--success);
      }

      .status-badge.late {
        background: #ffebee;
        color: var(--error);
      }

      .status-badge.available {
        background: #e8f5e9;
        color: var(--success);
      }

      .status-badge.unavailable {
        background: #ffebee;
        color: var(--error);
      }

      .empty-state {
        text-align: center;
        padding: 3rem 2rem;
        color: var(--text-muted);
      }

      .empty-state-icon {
        font-size: 4rem;
        margin-bottom: 1rem;
        opacity: 0.5;
      }

      .empty-state-text {
        font-size: 1.1rem;
        margin-bottom: 0.5rem;
      }

      .empty-state-subtext {
        font-size: 0.95rem;
        opacity: 0.8;
      }

      /* Quick Actions */
      .quick-actions {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin-top: 2rem;
      }

      .quick-action-btn {
        padding: 1.2rem;
        background: linear-gradient(
          135deg,
          var(--primary) 0%,
          var(--secondary) 100%
        );
        color: var(--cream);
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        font-family: "Lora", serif;
        box-shadow: 0 4px 15px rgba(139, 69, 19, 0.2);
        text-align: center;
      }

      .quick-action-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 20px rgba(139, 69, 19, 0.3);
      }

      .quick-action-icon {
        font-size: 1.5rem;
        margin-bottom: 0.5rem;
        display: block;
      }

      /* Books Management Styles */
      .tabs-container {
        display: flex;
        gap: 1rem;
        margin-bottom: 2rem;
        border-bottom: 2px solid var(--border);
      }

      .tab-button {
        padding: 1rem 2rem;
        background: none;
        border: none;
        border-bottom: 3px solid transparent;
        color: var(--text-muted);
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        font-family: "Lora", serif;
        position: relative;
      }

      .tab-button:hover {
        color: var(--primary);
      }

      .tab-button.active {
        color: var(--primary-dark);
        border-bottom-color: var(--primary);
      }

      .tab-badge {
        display: inline-block;
        background: var(--primary);
        color: white;
        padding: 0.2rem 0.6rem;
        border-radius: 12px;
        font-size: 0.8rem;
        margin-left: 0.5rem;
        font-weight: 600;
      }

      .borrow-cards-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        gap: 1.5rem;
      }

      .borrow-card {
        background: white;
        border-radius: 12px;
        padding: 1.5rem;
        box-shadow: 0 4px 20px rgba(139, 69, 19, 0.1);
        border: 1px solid var(--border);
        transition: all 0.3s ease;
        animation: fadeInUp 0.5s ease-out backwards;
        position: relative;
        overflow: hidden;
      }

      .borrow-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(to right, var(--primary), var(--secondary));
      }

      .borrow-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 30px rgba(139, 69, 19, 0.15);
      }

      .borrow-card-header {
        display: flex;
        justify-content: space-between;
        align-items: start;
        margin-bottom: 1rem;
      }

      .borrow-id {
        font-size: 0.9rem;
        color: var(--text-muted);
        font-weight: 600;
      }

      .borrow-book-title {
        font-size: 1.2rem;
        color: var(--primary-dark);
        font-weight: 600;
        margin: 0.5rem 0;
      }

      .borrow-member-name {
        color: var(--text-muted);
        font-size: 0.95rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .borrow-details {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
        margin-top: 1rem;
        padding-top: 1rem;
        border-top: 1px solid var(--border);
      }

      .borrow-detail-row {
        display: flex;
        justify-content: space-between;
        font-size: 0.9rem;
      }

      .borrow-detail-label {
        color: var(--text-muted);
      }

      .borrow-detail-value {
        font-weight: 600;
        color: var(--text-dark);
      }

      .borrow-detail-value.overdue {
        color: var(--error);
        font-weight: 700;
      }

      .borrow-actions {
        display: flex;
        gap: 0.5rem;
        margin-top: 1rem;
      }

      .btn-return {
        flex: 1;
        padding: 0.8rem;
        background: linear-gradient(135deg, var(--success) 0%, #3d6b1f 100%);
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 0.95rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        font-family: "Lora", serif;
      }

      .btn-return:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(45, 80, 22, 0.4);
      }

      .btn-history {
        padding: 0.8rem 1.2rem;
        background: var(--warm-white);
        color: var(--text-dark);
        border: 2px solid var(--border);
        border-radius: 8px;
        font-size: 0.95rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        font-family: "Lora", serif;
      }

      .btn-history:hover {
        background: var(--cream);
        border-color: var(--primary);
      }

      /* Select Dropdowns */
      .form-select {
        width: 100%;
        padding: 0.9rem 1.2rem;
        border: 2px solid var(--border);
        border-radius: 8px;
        font-size: 1rem;
        font-family: "Lora", serif;
        transition: all 0.3s ease;
        background: white;
        cursor: pointer;
      }

      .form-select:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 4px rgba(139, 69, 19, 0.1);
      }

      .form-select option {
        padding: 0.5rem;
      }

      .issue-form-grid {
        display: grid;
        gap: 1.5rem;
      }

      /* History View */
      .history-timeline {
        position: relative;
        padding-left: 2rem;
      }

      .history-timeline::before {
        content: "";
        position: absolute;
        left: 0.5rem;
        top: 0;
        bottom: 0;
        width: 2px;
        background: var(--border);
      }

      .history-item {
        position: relative;
        background: white;
        border-radius: 12px;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        box-shadow: 0 2px 12px rgba(139, 69, 19, 0.08);
        border: 1px solid var(--border);
        animation: fadeInLeft 0.5s ease-out backwards;
      }

      @keyframes fadeInLeft {
        from {
          opacity: 0;
          transform: translateX(-20px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      .history-item::before {
        content: "";
        position: absolute;
        left: -2rem;
        top: 1.5rem;
        width: 12px;
        height: 12px;
        background: var(--primary);
        border-radius: 50%;
        border: 3px solid white;
        box-shadow: 0 0 0 2px var(--primary);
      }

      .history-item.returned::before {
        background: var(--success);
        box-shadow: 0 0 0 2px var(--success);
      }

      .history-item.late::before {
        background: var(--error);
        box-shadow: 0 0 0 2px var(--error);
      }

      /* Filter Buttons */
      .filter-buttons {
        display: flex;
        gap: 0.75rem;
        flex-wrap: wrap;
        margin-bottom: 1.5rem;
      }

      .filter-btn {
        padding: 0.6rem 1.2rem;
        background: white;
        border: 2px solid var(--border);
        border-radius: 20px;
        color: var(--text-dark);
        font-size: 0.9rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        font-family: "Lora", serif;
      }

      .filter-btn:hover {
        border-color: var(--primary);
        color: var(--primary);
      }

      .filter-btn.active {
        background: linear-gradient(
          135deg,
          var(--primary) 0%,
          var(--secondary) 100%
        );
        color: white;
        border-color: var(--primary);
      }

      .page-actions {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
        flex-wrap: wrap;
        gap: 1rem;
      }

      .search-box {
        flex: 1;
        max-width: 400px;
        position: relative;
      }

      .search-input {
        width: 100%;
        padding: 0.9rem 1.2rem 0.9rem 3rem;
        border: 2px solid var(--border);
        border-radius: 8px;
        font-size: 1rem;
        font-family: "Lora", serif;
        transition: all 0.3s ease;
        background: white;
      }

      .search-input:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 4px rgba(139, 69, 19, 0.1);
      }

      .search-icon {
        position: absolute;
        left: 1rem;
        top: 50%;
        transform: translateY(-50%);
        font-size: 1.2rem;
        color: var(--text-muted);
      }

      .btn-add {
        padding: 0.9rem 2rem;
        background: linear-gradient(
          135deg,
          var(--primary) 0%,
          var(--secondary) 100%
        );
        color: var(--cream);
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        font-family: "Lora", serif;
        box-shadow: 0 4px 15px rgba(139, 69, 19, 0.3);
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .btn-add:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(139, 69, 19, 0.4);
      }

      /* Data Table */
      .data-table-container {
        background: white;
        border-radius: 12px;
        box-shadow: 0 4px 20px rgba(139, 69, 19, 0.1);
        border: 1px solid var(--border);
        overflow: hidden;
        animation: fadeIn 0.5s ease-out;
      }

      .data-table {
        width: 100%;
        border-collapse: collapse;
      }

      .data-table thead {
        background: linear-gradient(
          to right,
          var(--primary-dark),
          var(--primary)
        );
        color: var(--cream);
      }

      .data-table th {
        padding: 1.2rem 1rem;
        text-align: left;
        font-weight: 600;
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .data-table td {
        padding: 1.2rem 1rem;
        border-bottom: 1px solid var(--border);
        color: var(--text-dark);
      }

      .data-table tbody tr {
        transition: all 0.3s ease;
      }

      .data-table tbody tr:hover {
        background: var(--warm-white);
        transform: scale(1.01);
        box-shadow: 0 2px 8px rgba(139, 69, 19, 0.1);
      }

      .data-table tbody tr:last-child td {
        border-bottom: none;
      }

      .table-actions {
        display: flex;
        gap: 0.5rem;
      }

      .btn-icon {
        padding: 0.5rem 0.8rem;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 1rem;
        transition: all 0.3s ease;
        background: var(--warm-white);
        color: var(--text-dark);
        border: 1px solid var(--border);
      }

      .btn-icon:hover {
        transform: translateY(-2px);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      .btn-icon.edit:hover {
        background: #e3f2fd;
        color: #1976d2;
        border-color: #1976d2;
      }

      .btn-icon.delete:hover {
        background: #ffebee;
        color: var(--error);
        border-color: var(--error);
      }

      /* Modal Styles */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.6);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        animation: fadeIn 0.3s ease-out;
        backdrop-filter: blur(4px);
      }

      .modal-container {
        background: white;
        border-radius: 16px;
        padding: 2rem;
        max-width: 600px;
        width: 90%;
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        animation: slideUp 0.4s ease-out;
        position: relative;
      }

      @keyframes slideUp {
        from {
          opacity: 0;
          transform: translateY(50px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
        padding-bottom: 1rem;
        border-bottom: 2px solid var(--border);
      }

      .modal-title {
        font-size: 1.8rem;
        color: var(--primary-dark);
        font-weight: 700;
      }

      .btn-close {
        background: none;
        border: none;
        font-size: 1.5rem;
        cursor: pointer;
        color: var(--text-muted);
        transition: all 0.3s ease;
        padding: 0.5rem;
        border-radius: 50%;
      }

      .btn-close:hover {
        background: var(--warm-white);
        color: var(--text-dark);
        transform: rotate(90deg);
      }

      .modal-form {
        display: flex;
        flex-direction: column;
        gap: 1.2rem;
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
      }

      .btn-secondary {
        padding: 0.9rem 2rem;
        background: var(--warm-white);
        color: var(--text-dark);
        border: 2px solid var(--border);
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        font-family: "Lora", serif;
      }

      .btn-secondary:hover {
        background: var(--cream);
        border-color: var(--primary);
      }

      .modal-actions {
        display: flex;
        gap: 1rem;
        margin-top: 1.5rem;
      }

      .modal-actions button {
        flex: 1;
      }

      /* Confirmation Dialog */
      .confirm-dialog {
        max-width: 450px;
      }

      .confirm-message {
        font-size: 1.1rem;
        color: var(--text-dark);
        margin: 1.5rem 0;
        line-height: 1.6;
      }

      .confirm-detail {
        background: var(--warm-white);
        padding: 1rem;
        border-radius: 8px;
        margin: 1rem 0;
        border-left: 4px solid var(--primary);
      }

      .confirm-detail strong {
        color: var(--primary-dark);
      }

      .btn-danger {
        background: linear-gradient(135deg, var(--error) 0%, #a00000 100%);
        color: white;
      }

      .btn-danger:hover {
        box-shadow: 0 6px 20px rgba(139, 0, 0, 0.4);
      }

      /* Book Card View (Alternative) */
      .books-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 1.5rem;
        margin-top: 2rem;
      }

      .book-card {
        background: white;
        border-radius: 12px;
        padding: 1.5rem;
        box-shadow: 0 4px 20px rgba(139, 69, 19, 0.1);
        border: 1px solid var(--border);
        transition: all 0.3s ease;
        animation: fadeInUp 0.5s ease-out backwards;
      }

      .book-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 30px rgba(139, 69, 19, 0.15);
      }

      .book-card-header {
        display: flex;
        justify-content: space-between;
        align-items: start;
        margin-bottom: 1rem;
      }

      .book-title {
        font-size: 1.3rem;
        color: var(--primary-dark);
        font-weight: 600;
        margin-bottom: 0.5rem;
      }

      .book-author {
        color: var(--text-muted);
        font-size: 0.95rem;
        margin-bottom: 1rem;
      }

      .book-details {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
        margin-top: 1rem;
        padding-top: 1rem;
        border-top: 1px solid var(--border);
      }

      .book-detail-item {
        display: flex;
        justify-content: space-between;
        font-size: 0.9rem;
      }

      .book-detail-label {
        color: var(--text-muted);
      }

      .book-detail-value {
        font-weight: 600;
        color: var(--text-dark);
      }

      /* View Toggle */
      .view-toggle {
        display: flex;
        gap: 0.5rem;
        background: var(--warm-white);
        padding: 0.3rem;
        border-radius: 8px;
        border: 1px solid var(--border);
      }

      .view-toggle-btn {
        padding: 0.5rem 1rem;
        background: transparent;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 1.2rem;
        transition: all 0.3s ease;
        color: var(--text-muted);
      }

      .view-toggle-btn.active {
        background: white;
        color: var(--primary);
        box-shadow: 0 2px 8px rgba(139, 69, 19, 0.1);
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        .navbar {
          flex-direction: column;
          gap: 1rem;
        }

        .navbar-menu {
          flex-wrap: wrap;
          justify-content: center;
        }

        .auth-box {
          padding: 2rem 1.5rem;
        }

        .page-title {
          font-size: 2rem;
        }

        .stats-grid {
          grid-template-columns: 1fr;
        }

        .stat-value {
          font-size: 2rem;
        }

        .section-header {
          flex-direction: column;
          align-items: flex-start;
          gap: 1rem;
        }

        .activity-table {
          font-size: 0.85rem;
        }

        .activity-table th,
        .activity-table td {
          padding: 0.75rem 0.5rem;
        }

        .page-actions {
          flex-direction: column;
          align-items: stretch;
        }

        .search-box {
          max-width: 100%;
        }

        .form-row {
          grid-template-columns: 1fr;
        }

        .data-table {
          font-size: 0.85rem;
        }

        .data-table th,
        .data-table td {
          padding: 0.8rem 0.5rem;
        }

        .table-actions {
          flex-direction: column;
        }

        .modal-container {
          width: 95%;
          padding: 1.5rem;
        }

        .modal-actions {
          flex-direction: column;
        }
      }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect } = React;

      // API Configuration
      const API_BASE_URL = "https://library-management-repo.onrender.com";

      // API Helper Functions
      const api = {
        login: async (email, password) => {
          const response = await fetch(`${API_BASE_URL}/auth/login`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email, password }),
          });
          return response.json();
        },
        register: async (name, email, password) => {
          const response = await fetch(`${API_BASE_URL}/auth/register`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ name, email, password }),
          });
          return response.json();
        },
        // Books API
        getBooks: async (token) => {
          const response = await fetch(`${API_BASE_URL}/book/getAllBooks`, {
            headers: {
              Authorization: `Bearer ${token}`,
              "Content-Type": "application/json",
            },
          });
          if (!response.ok) throw new Error("Failed to fetch books");
          const data2 = await response.json();

          return data2;
        },
        addBook: async (token, bookData) => {
          const response = await fetch(`${API_BASE_URL}/book/addBook`, {
            method: "POST",
            headers: {
              Authorization: `Bearer ${token}`,
              "Content-Type": "application/json",
            },
            body: JSON.stringify(bookData),
          });
          if (!response.ok) throw new Error("Failed to add book");
          return response.json();
        },
        updateBook: async (token, id, bookData) => {
          const response = await fetch(
            `${API_BASE_URL}/book/updateBook/${id}`,
            {
              method: "PUT",
              headers: {
                Authorization: `Bearer ${token}`,
                "Content-Type": "application/json",
              },
              body: JSON.stringify(bookData),
            },
          );
          if (!response.ok) throw new Error("Failed to update book");
          return response.json();
        },
        deleteBook: async (token, id) => {
          const response = await fetch(
            `${API_BASE_URL}/book/deleteBook/${id}`,
            {
              method: "DELETE",
              headers: {
                Authorization: `Bearer ${token}`,
                "Content-Type": "application/json",
              },
            },
          );
          if (!response.ok) throw new Error("Failed to delete book");
          return response.json();
        },
        // Members API
        getMembers: async (token) => {
          const response = await fetch(`${API_BASE_URL}/member/getAllMember`, {
            headers: {
              Authorization: `Bearer ${token}`,
              "Content-Type": "application/json",
            },
          });
          if (!response.ok) throw new Error("Failed to fetch members");
          const data2 = await response.json();
          return data2;
        },
        addMember: async (token, memberData) => {
          const response = await fetch(`${API_BASE_URL}/member/createMember`, {
            method: "POST",
            headers: {
              Authorization: `Bearer ${token}`,
              "Content-Type": "application/json",
            },
            body: JSON.stringify(memberData),
          });
          if (!response.ok) throw new Error("Failed to add member");
          return response.json();
        },
        updateMember: async (token, id, memberData) => {
          const response = await fetch(
            `${API_BASE_URL}/member/updateMember/${id}`,
            {
              method: "PUT",
              headers: {
                Authorization: `Bearer ${token}`,
                "Content-Type": "application/json",
              },
              body: JSON.stringify(memberData),
            },
          );
          if (!response.ok) throw new Error("Failed to update member");
          return response.json();
        },
        deleteMember: async (token, id) => {
          const response = await fetch(
            `${API_BASE_URL}/member/deleteMember/${id}`,
            {
              method: "DELETE",
              headers: {
                Authorization: `Bearer ${token}`,
                "Content-Type": "application/json",
              },
            },
          );

          const data2 = await response.json();

          if (!response.ok)
            throw new Error(data2.message, "Failed to delete member");

          return data2;
        },
        // Borrow API
        issueBook: async (token, bookId, memberId) => {
          const response = await fetch(
            `${API_BASE_URL}/borrow/issueBook/${bookId}/${memberId}`,
            {
              method: "POST",
              headers: {
                Authorization: `Bearer ${token}`,
                "Content-Type": "application/json",
              },
            },
          );
          if (!response.ok) throw new Error("Failed to issue book");
          return response.json();
        },
        returnBook: async (token, borrowId) => {
          const response = await fetch(
            `${API_BASE_URL}/borrow/returnBook/${borrowId}`,
            {
              method: "PUT",
              headers: {
                Authorization: `Bearer ${token}`,
                "Content-Type": "application/json",
              },
            },
          );
          if (!response.ok) throw new Error("Failed to return book");
          return response.json();
        },
        getBorrowHistory: async (token, memberId) => {
          const response = await fetch(
            `${API_BASE_URL}/borrow/history/${memberId}`,
            {
              headers: {
                Authorization: `Bearer ${token}`,
                "Content-Type": "application/json",
              },
            },
          );
          if (!response.ok) throw new Error("Failed to fetch borrow history");
          return response.json();
        },
      };

      // Login Component
      function Login({ onLogin, onSwitchToRegister }) {
        const [email, setEmail] = useState("");
        const [password, setPassword] = useState("");
        const [error, setError] = useState("");
        const [loading, setLoading] = useState(false);

        const handleSubmit = async (e) => {
          e.preventDefault();
          setError("");
          setLoading(true);

          try {
            const result = await api.login(email, password);

            if (result.token) {
              localStorage.setItem("token", result.token);
              localStorage.setItem("userName", result.name || email);
              onLogin(result.token);
            } else {
              setError(
                result.message ||
                  "Login failed. Please check your credentials.",
              );
            }
          } catch (err) {
            setError("Unable to connect to server. Please try again.");
          } finally {
            setLoading(false);
          }
        };

        return (
          <div className="auth-container">
            <div className="auth-box">
              <div className="auth-header">
                <h1 className="auth-title">Welcome Back</h1>
                <p className="auth-subtitle">Sign in to your library account</p>
              </div>

              {error && <div className="alert alert-error">{error}</div>}

              <form onSubmit={handleSubmit}>
                <div className="form-group">
                  <label className="form-label">Email Address</label>
                  <input
                    type="email"
                    className="form-input"
                    placeholder="your.email@example.com"
                    value={email}
                    onChange={(e) => setEmail(e.target.value)}
                    required
                  />
                </div>

                <div className="form-group">
                  <label className="form-label">Password</label>
                  <input
                    type="password"
                    className="form-input"
                    placeholder="Enter your password"
                    value={password}
                    onChange={(e) => setPassword(e.target.value)}
                    required
                  />
                </div>

                <button
                  type="submit"
                  className="btn-primary"
                  disabled={loading}
                >
                  {loading ? "Signing In..." : "Sign In"}
                </button>
              </form>

              <div className="auth-switch">
                Don't have an account?
                <a
                  href="#"
                  className="auth-switch-link"
                  onClick={onSwitchToRegister}
                >
                  Register here
                </a>
              </div>
            </div>
          </div>
        );
      }

      // Register Component
      function Register({ onSwitchToLogin }) {
        const [name, setName] = useState("");
        const [email, setEmail] = useState("");
        const [password, setPassword] = useState("");
        const [confirmPassword, setConfirmPassword] = useState("");
        const [error, setError] = useState("");
        const [success, setSuccess] = useState("");
        const [loading, setLoading] = useState(false);

        const handleSubmit = async (e) => {
          e.preventDefault();
          setError("");
          setSuccess("");

          if (password !== confirmPassword) {
            setError("Passwords do not match!");
            return;
          }

          if (password.length < 6) {
            setError("Password must be at least 6 characters long");
            return;
          }

          setLoading(true);

          try {
            const result = await api.register(name, email, password);

            if (result.message === "User registered successfully") {
              setSuccess("Registration successful! Please sign in.");
              setTimeout(() => {
                onSwitchToLogin();
              }, 2000);
            } else {
              setError(
                result.message || "Registration failed. Please try again.",
              );
            }
          } catch (err) {
            setError("Unable to connect to server. Please try again.");
          } finally {
            setLoading(false);
          }
        };

        return (
          <div className="auth-container">
            <div className="auth-box">
              <div className="auth-header">
                <h1 className="auth-title">Create Account</h1>
                <p className="auth-subtitle">
                  Join our library management system
                </p>
              </div>

              {error && <div className="alert alert-error">{error}</div>}

              {success && <div className="alert alert-success">{success}</div>}

              <form onSubmit={handleSubmit}>
                <div className="form-group">
                  <label className="form-label">Full Name</label>
                  <input
                    type="text"
                    className="form-input"
                    placeholder="John Doe"
                    value={name}
                    onChange={(e) => setName(e.target.value)}
                    required
                  />
                </div>

                <div className="form-group">
                  <label className="form-label">Email Address</label>
                  <input
                    type="email"
                    className="form-input"
                    placeholder="your.email@example.com"
                    value={email}
                    onChange={(e) => setEmail(e.target.value)}
                    required
                  />
                </div>

                <div className="form-group">
                  <label className="form-label">Password</label>
                  <input
                    type="password"
                    className="form-input"
                    placeholder="Min. 6 characters"
                    value={password}
                    onChange={(e) => setPassword(e.target.value)}
                    required
                  />
                </div>

                <div className="form-group">
                  <label className="form-label">Confirm Password</label>
                  <input
                    type="password"
                    className="form-input"
                    placeholder="Re-enter your password"
                    value={confirmPassword}
                    onChange={(e) => setConfirmPassword(e.target.value)}
                    required
                  />
                </div>

                <button
                  type="submit"
                  className="btn-primary"
                  disabled={loading}
                >
                  {loading ? "Creating Account..." : "Create Account"}
                </button>
              </form>

              <div className="auth-switch">
                Already have an account?
                <a
                  href="#"
                  className="auth-switch-link"
                  onClick={onSwitchToLogin}
                >
                  Sign in here
                </a>
              </div>
            </div>
          </div>
        );
      }

      // Borrow System Component
      function BorrowSystem({ onLogout, userName }) {
        const [activeTab, setActiveTab] = useState("issue"); // issue, active, history
        const [books, setBooks] = useState([]);
        const [members, setMembers] = useState([]);
        const [borrowHistory, setBorrowHistory] = useState([]);
        const [loading, setLoading] = useState(true);
        const [selectedBookId, setSelectedBookId] = useState("");
        const [selectedMemberId, setSelectedMemberId] = useState("");
        const [historyMemberId, setHistoryMemberId] = useState("");
        const [error, setError] = useState("");
        const [success, setSuccess] = useState("");
        const [filterStatus, setFilterStatus] = useState("all"); // all, issued, returned, late

        useEffect(() => {
          loadInitialData();
        }, []);

        const loadInitialData = async () => {
          try {
            const token = localStorage.getItem("token");
            const [booksData, membersData] = await Promise.all([
              api.getBooks(token),
              api.getMembers(token),
            ]);
            setBooks(booksData);
            setMembers(membersData);
          } catch (error) {
            setError("Failed to load data");
          } finally {
            setLoading(false);
          }
        };

        const handleIssueBook = async (e) => {
          e.preventDefault();
          setError("");
          setSuccess("");

          if (!selectedBookId || !selectedMemberId) {
            setError("Please select both a book and a member");
            return;
          }

          try {
            const token = localStorage.getItem("token");
            await api.issueBook(token, selectedBookId, selectedMemberId);

            setSuccess(
              "Book issued successfully! Due date is 7 days from today.",
            );
            setSelectedBookId("");
            setSelectedMemberId("");
            loadInitialData(); // Refresh data

            setTimeout(() => setSuccess(""), 5000);
          } catch (error) {
            setError("Failed to issue book. The book may not be available.");
          }
        };

        const handleReturnBook = async (borrowId) => {
          setError("");
          setSuccess("");

          try {
            const token = localStorage.getItem("token");
            const result = await api.returnBook(token, borrowId);

            if (result.status === "LATE") {
              setSuccess(
                "Book returned successfully, but it was returned late.",
              );
            } else {
              setSuccess("Book returned successfully on time!");
            }

            loadInitialData(); // Refresh data
            if (historyMemberId) {
              loadBorrowHistory(historyMemberId);
            }

            setTimeout(() => setSuccess(""), 5000);
          } catch (error) {
            setError("Failed to return book. Please try again.");
          }
        };

        const loadBorrowHistory = async (memberId) => {
          setError("");
          setHistoryMemberId(memberId);

          if (!memberId) {
            setBorrowHistory([]);
            return;
          }

          try {
            const token = localStorage.getItem("token");
            const history = await api.getBorrowHistory(token, memberId);
            setBorrowHistory(history);
          } catch (error) {
            setError("Failed to load borrow history");
            setBorrowHistory([]);
          }
        };

        const getActiveBorrows = () => {
          return books.flatMap((book) => {
            const borrowed = (book.quantity || 0) - (book.available || 0);
            if (borrowed > 0) {
              // Create placeholder entries for active borrows
              // In a real app, you'd have a separate endpoint for this
              return [
                {
                  book: book,
                  borrowed: borrowed,
                },
              ];
            }
            return [];
          });
        };

        const formatDate = (dateString) => {
          if (!dateString) return "N/A";
          const date = new Date(dateString);
          return date.toLocaleDateString("en-US", {
            year: "numeric",
            month: "short",
            day: "numeric",
          });
        };

        const formatDateTime = (dateString) => {
          if (!dateString) return "N/A";
          const date = new Date(dateString);
          return date.toLocaleString("en-US", {
            year: "numeric",
            month: "short",
            day: "numeric",
            hour: "2-digit",
            minute: "2-digit",
          });
        };

        const isOverdue = (dueDate) => {
          if (!dueDate) return false;
          return new Date(dueDate) < new Date();
        };

        const getFilteredHistory = () => {
          if (filterStatus === "all") return borrowHistory;
          return borrowHistory.filter((item) => {
            if (filterStatus === "issued") return item.status === "ISSUED";
            if (filterStatus === "returned") return item.status === "RETURNED";
            if (filterStatus === "late") return item.status === "LATE";
            return true;
          });
        };

        const availableBooks = books.filter((book) => book.available > 0);
        const activeBorrows = getActiveBorrows();
        console.log(activeBorrows);
        
        const filteredHistory = getFilteredHistory();

        if (loading) {
          return (
            <div className="app-container">
              <nav className="navbar">
                <div className="navbar-brand">Library System</div>
                <div className="navbar-menu">
                  <a href="#dashboard" className="nav-link">
                    Dashboard
                  </a>
                  <a href="#books" className="nav-link">
                    Books
                  </a>
                  <a href="#members" className="nav-link">
                    Members
                  </a>
                  <a href="#borrow" className="nav-link active">
                    Borrow
                  </a>
                  <button className="logout-btn" onClick={onLogout}>
                    Logout
                  </button>
                </div>
              </nav>
              <main className="main-content">
                <div className="loading-container">
                  <div className="spinner"></div>
                </div>
              </main>
            </div>
          );
        }

        return (
          <div className="app-container">
            <nav className="navbar">
              <div className="navbar-brand">Library System</div>
              <div className="navbar-menu">
                <a href="#dashboard" className="nav-link">
                  Dashboard
                </a>
                <a href="#books" className="nav-link">
                  Books
                </a>
                <a href="#members" className="nav-link">
                  Members
                </a>
                <a href="#borrow" className="nav-link active">
                  Borrow
                </a>
                <button className="logout-btn" onClick={onLogout}>
                  Logout
                </button>
              </div>
            </nav>

            <main className="main-content">
              <div className="page-header">
                <h1 className="page-title">Borrow Management</h1>
                <p className="page-description">
                  Issue and return books, view borrow history
                </p>
              </div>

              {success && <div className="alert alert-success">{success}</div>}

              {error && <div className="alert alert-error">{error}</div>}

              {/* Tabs */}
              <div className="tabs-container">
                <button
                  className={`tab-button ${activeTab === "issue" ? "active" : ""}`}
                  onClick={() => setActiveTab("issue")}
                >
                  ðŸ“¤ Issue Book
                </button>
                <button
                  className={`tab-button ${activeTab === "active" ? "active" : ""}`}
                  onClick={() => setActiveTab("active")}
                >
                  ðŸ“– Active Borrows
                  {activeBorrows.length > 0 && (
                    <span className="tab-badge">{activeBorrows.length}</span>
                  )}
                </button>
                <button
                  className={`tab-button ${activeTab === "history" ? "active" : ""}`}
                  onClick={() => setActiveTab("history")}
                >
                  ðŸ“‹ Borrow History
                </button>
              </div>

              {/* Issue Book Tab */}
              {activeTab === "issue" && (
                <div className="dashboard-section">
                  <div className="section-header">
                    <h2 className="section-title">Issue a Book to Member</h2>
                  </div>
                  <form onSubmit={handleIssueBook} className="issue-form-grid">
                    <div className="form-group">
                      <label className="form-label">Select Book *</label>
                      <select
                        className="form-select"
                        value={selectedBookId}
                        onChange={(e) => setSelectedBookId(e.target.value)}
                        required
                      >
                        <option value="">-- Choose a book --</option>
                        {availableBooks.map((book) => (
                          <option key={book.id} value={book.id}>
                            {book.title} by {book.author} (Available:{" "}
                            {book.available})
                          </option>
                        ))}
                      </select>
                      {availableBooks.length === 0 && (
                        <p
                          style={{
                            color: "var(--error)",
                            marginTop: "0.5rem",
                            fontSize: "0.9rem",
                          }}
                        >
                          âš ï¸ No books currently available
                        </p>
                      )}
                    </div>

                    <div className="form-group">
                      <label className="form-label">Select Member *</label>
                      <select
                        className="form-select"
                        value={selectedMemberId}
                        onChange={(e) => setSelectedMemberId(e.target.value)}
                        required
                      >
                        <option value="">-- Choose a member --</option>
                        {members.map((member) => (
                          <option key={member.id} value={member.id}>
                            {member.name} ({member.email})
                          </option>
                        ))}
                      </select>
                      {members.length === 0 && (
                        <p
                          style={{
                            color: "var(--error)",
                            marginTop: "0.5rem",
                            fontSize: "0.9rem",
                          }}
                        >
                          âš ï¸ No members registered
                        </p>
                      )}
                    </div>

                    <div
                      style={{
                        background: "var(--warm-white)",
                        padding: "1rem",
                        borderRadius: "8px",
                        border: "1px solid var(--border)",
                      }}
                    >
                      <strong>ðŸ“… Loan Period:</strong> 7 days from issue date
                      <br />
                      <strong>â° Due Date:</strong> Automatically calculated
                    </div>

                    <button
                      type="submit"
                      className="btn-primary"
                      disabled={
                        availableBooks.length === 0 || members.length === 0
                      }
                    >
                      ðŸ“¤ Issue Book
                    </button>
                  </form>
                </div>
              )}

              {/* Active Borrows Tab */}
              {activeTab === "active" && (
                <div>
                  {activeBorrows.length > 0 ? (
                    <div className="borrow-cards-grid">
                      {activeBorrows.map((borrow, index) => (
                        <div key={index} className="borrow-card">
                          <div className="borrow-card-header">
                            <span className="status-badge issued">
                              Currently Borrowed
                            </span>
                          </div>
                          <h3 className="borrow-book-title">
                            {borrow.book.title}
                          </h3>
                          <p className="borrow-member-name">
                            ðŸ‘¤ Author: {borrow.book.author}
                          </p>
                          <div className="borrow-details">
                            <div className="borrow-detail-row">
                              <span className="borrow-detail-label">ISBN</span>
                              <span className="borrow-detail-value">
                                {borrow.book.isbn}
                              </span>
                            </div>
                            <div className="borrow-detail-row">
                              <span className="borrow-detail-label">
                                Total Copies
                              </span>
                              <span className="borrow-detail-value">
                                {borrow.book.quantity}
                              </span>
                            </div>
                            <div className="borrow-detail-row">
                              <span className="borrow-detail-label">
                                Currently Borrowed
                              </span>
                              <span className="borrow-detail-value">
                                {borrow.borrowed}
                              </span>
                            </div>
                            <div className="borrow-detail-row">
                              <span className="borrow-detail-label">
                                Available
                              </span>
                              <span className="borrow-detail-value">
                                {borrow.book.available}
                              </span>
                            </div>
                          </div>
                        </div>
                      ))}
                    </div>
                  ) : (
                    <div className="empty-state">
                      <div className="empty-state-icon">ðŸ“–</div>
                      <div className="empty-state-text">No active borrows</div>
                      <div className="empty-state-subtext">
                        All books are currently available in the library
                      </div>
                    </div>
                  )}
                </div>
              )}

              {/* Borrow History Tab */}
              {activeTab === "history" && (
                <div>
                  <div
                    className="dashboard-section"
                    style={{ marginBottom: "2rem" }}
                  >
                    <div className="form-group">
                      <label className="form-label">
                        Select Member to View History
                      </label>
                      <select
                        className="form-select"
                        value={historyMemberId}
                        onChange={(e) => loadBorrowHistory(e.target.value)}
                      >
                        <option value="">-- Choose a member --</option>
                        {members.map((member) => (
                          <option key={member.id} value={member.id}>
                            {member.name} ({member.email})
                          </option>
                        ))}
                      </select>
                    </div>
                  </div>

                  {historyMemberId && borrowHistory.length > 0 && (
                    <div className="filter-buttons">
                      <button
                        className={`filter-btn ${filterStatus === "all" ? "active" : ""}`}
                        onClick={() => setFilterStatus("all")}
                      >
                        All ({borrowHistory.length})
                      </button>
                      <button
                        className={`filter-btn ${filterStatus === "issued" ? "active" : ""}`}
                        onClick={() => setFilterStatus("issued")}
                      >
                        ðŸ“¤ Issued (
                        {
                          borrowHistory.filter((b) => b.status === "ISSUED")
                            .length
                        }
                        )
                      </button>
                      <button
                        className={`filter-btn ${filterStatus === "returned" ? "active" : ""}`}
                        onClick={() => setFilterStatus("returned")}
                      >
                        âœ… Returned (
                        {
                          borrowHistory.filter((b) => b.status === "RETURNED")
                            .length
                        }
                        )
                      </button>
                      <button
                        className={`filter-btn ${filterStatus === "late" ? "active" : ""}`}
                        onClick={() => setFilterStatus("late")}
                      >
                        â° Late (
                        {
                          borrowHistory.filter((b) => b.status === "LATE")
                            .length
                        }
                        )
                      </button>
                    </div>
                  )}

                  {historyMemberId && filteredHistory.length > 0 ? (
                    <div className="history-timeline">
                      {filteredHistory.map((item) => (
                        <div
                          key={item.borrow_id}
                          className={`history-item ${item.status.toLowerCase()}`}
                        >
                          <div
                            style={{
                              display: "flex",
                              justifyContent: "space-between",
                              alignItems: "start",
                              marginBottom: "1rem",
                            }}
                          >
                            <div>
                              <h3
                                style={{
                                  fontSize: "1.2rem",
                                  color: "var(--primary-dark)",
                                  marginBottom: "0.3rem",
                                }}
                              >
                                {item.book.title}
                              </h3>
                              <p
                                style={{
                                  color: "var(--text-muted)",
                                  fontSize: "0.9rem",
                                }}
                              >
                                by {item.book.author}
                              </p>
                            </div>
                            <span
                              className={`status-badge ${item.status.toLowerCase()}`}
                            >
                              {item.status}
                            </span>
                          </div>
                          <div className="borrow-details">
                            <div className="borrow-detail-row">
                              <span className="borrow-detail-label">
                                ðŸ“¤ Issue Date
                              </span>
                              <span className="borrow-detail-value">
                                {formatDateTime(item.issue_date)}
                              </span>
                            </div>
                            <div className="borrow-detail-row">
                              <span className="borrow-detail-label">
                                â° Due Date
                              </span>
                              <span
                                className={`borrow-detail-value ${isOverdue(item.due_date) && item.status === "ISSUED" ? "overdue" : ""}`}
                              >
                                {formatDateTime(item.due_date)}
                                {isOverdue(item.due_date) &&
                                  item.status === "ISSUED" &&
                                  " âš ï¸ OVERDUE"}
                              </span>
                            </div>
                            {item.return_date && (
                              <div className="borrow-detail-row">
                                <span className="borrow-detail-label">
                                  ðŸ“¥ Return Date
                                </span>
                                <span className="borrow-detail-value">
                                  {formatDateTime(item.return_date)}
                                </span>
                              </div>
                            )}
                            <div className="borrow-detail-row">
                              <span className="borrow-detail-label">
                                Member
                              </span>
                              <span className="borrow-detail-value">
                                {item.member.name}
                              </span>
                            </div>
                          </div>
                          {item.status === "ISSUED" && (
                            <div className="borrow-actions">
                              <button
                                className="btn-return"
                                onClick={() => handleReturnBook(item.borrow_id)}
                              >
                                ðŸ“¥ Return Book
                              </button>
                            </div>
                          )}
                        </div>
                      ))}
                    </div>
                  ) : historyMemberId ? (
                    <div className="empty-state">
                      <div className="empty-state-icon">ðŸ“‹</div>
                      <div className="empty-state-text">
                        No borrow history found
                      </div>
                      <div className="empty-state-subtext">
                        This member hasn't borrowed any books yet
                      </div>
                    </div>
                  ) : (
                    <div className="empty-state">
                      <div className="empty-state-icon">ðŸ‘†</div>
                      <div className="empty-state-text">
                        Select a member to view history
                      </div>
                      <div className="empty-state-subtext">
                        Choose a member from the dropdown above
                      </div>
                    </div>
                  )}
                </div>
              )}
            </main>
          </div>
        );
      }

      // Members Management Component
      function MembersManagement({ onLogout, userName }) {
        const [members, setMembers] = useState([]);
        const [filteredMembers, setFilteredMembers] = useState([]);
        const [loading, setLoading] = useState(true);
        const [searchTerm, setSearchTerm] = useState("");
        const [showAddModal, setShowAddModal] = useState(false);
        const [showEditModal, setShowEditModal] = useState(false);
        const [showDeleteModal, setShowDeleteModal] = useState(false);
        const [selectedMember, setSelectedMember] = useState(null);
        const [formData, setFormData] = useState({
          name: "",
          email: "",
          phone: "",
        });
        const [error, setError] = useState("");
        const [success, setSuccess] = useState("");

        useEffect(() => {
          loadMembers();
        }, []);

        useEffect(() => {
          // Filter members based on search term
          const filtered = members.filter(
            (member) =>
              member.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
              member.email.toLowerCase().includes(searchTerm.toLowerCase()) ||
              member.phone.toLowerCase().includes(searchTerm.toLowerCase()),
          );
          setFilteredMembers(filtered);
        }, [searchTerm, members]);

        const loadMembers = async () => {
          try {
            const token = localStorage.getItem("token");
            const data = await api.getMembers(token);
            setMembers(data);
            setFilteredMembers(data);
          } catch (error) {
            setError("Failed to load members");
          } finally {
            setLoading(false);
          }
        };

        const validateEmail = (email) => {
          const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
          return re.test(email);
        };

        const validatePhone = (phone) => {
          const re = /^[\d\s\-\+\(\)]+$/;
          return re.test(phone) && phone.replace(/\D/g, "").length >= 10;
        };

        const handleAddMember = async (e) => {
          e.preventDefault();
          setError("");
          setSuccess("");

          if (!validateEmail(formData.email)) {
            setError("Please enter a valid email address");
            return;
          }

          if (!validatePhone(formData.phone)) {
            setError("Please enter a valid phone number (min. 10 digits)");
            return;
          }

          try {
            const token = localStorage.getItem("token");
            await api.addMember(token, formData);

            setSuccess("Member added successfully!");
            setShowAddModal(false);
            setFormData({ name: "", email: "", phone: "" });
            loadMembers();

            setTimeout(() => setSuccess(""), 3000);
          } catch (error) {
            setError("Failed to add member");
          }
        };

        const handleEditMember = async (e) => {
          e.preventDefault();
          setError("");
          setSuccess("");

          if (!validateEmail(formData.email)) {
            setError("Please enter a valid email address");
            return;
          }

          if (!validatePhone(formData.phone)) {
            setError("Please enter a valid phone number (min. 10 digits)");
            return;
          }

          try {
            const token = localStorage.getItem("token");
            await api.updateMember(token, selectedMember.id, formData);

            setSuccess("Member updated successfully!");
            setShowEditModal(false);
            setSelectedMember(null);
            setFormData({ name: "", email: "", phone: "" });
            loadMembers();

            setTimeout(() => setSuccess(""), 3000);
          } catch (error) {
            setError("Failed to update member");
          }
        };

        const handleDeleteMember = async () => {
          setError("");
          setSuccess("");

          try {
            const token = localStorage.getItem("token");
            await api.deleteMember(token, selectedMember.id);

            setSuccess("Member deleted successfully!");
            setShowDeleteModal(false);
            setSelectedMember(null);
            loadMembers();

            setTimeout(() => setSuccess(""), 3000);
          } catch (error) {
            // console.log(error);
            // console.log();

            setError(error.message || "Failed to delete member");
            setShowDeleteModal(false);
            // setSelectedMember(null);
            // loadMembers();

            setTimeout(() => setError(""), 3000);
          }
        };

        const openEditModal = (member) => {
          setSelectedMember(member);
          setFormData({
            name: member.name,
            email: member.email,
            phone: member.phone,
          });
          setShowEditModal(true);
        };

        const openDeleteModal = (member) => {
          setSelectedMember(member);
          setShowDeleteModal(true);
        };

        const closeModals = () => {
          setShowAddModal(false);
          setShowEditModal(false);
          setShowDeleteModal(false);
          setSelectedMember(null);
          setFormData({ name: "", email: "", phone: "" });
          setError("");
        };

        const formatDate = (dateString) => {
          if (!dateString) return "N/A";
          const date = new Date(dateString);
          return date.toLocaleDateString("en-US", {
            year: "numeric",
            month: "short",
            day: "numeric",
          });
        };

        return (
          <div className="app-container">
            <nav className="navbar">
              <div className="navbar-brand">Library System</div>
              <div className="navbar-menu">
                <a href="#dashboard" className="nav-link">
                  Dashboard
                </a>
                <a href="#books" className="nav-link">
                  Books
                </a>
                <a href="#members" className="nav-link active">
                  Members
                </a>
                <a href="#borrow" className="nav-link">
                  Borrow
                </a>
                <button className="logout-btn" onClick={onLogout}>
                  Logout
                </button>
              </div>
            </nav>

            <main className="main-content">
              <div className="page-header">
                <h1 className="page-title">Members Management</h1>
                <p className="page-description">
                  Manage your library members and their information
                </p>
              </div>

              {success && <div className="alert alert-success">{success}</div>}

              {error && <div className="alert alert-error">{error}</div>}

              <div className="page-actions">
                <div className="search-box">
                  <span className="search-icon">ðŸ”</span>
                  <input
                    type="text"
                    className="search-input"
                    placeholder="Search by name, email, or phone..."
                    value={searchTerm}
                    onChange={(e) => setSearchTerm(e.target.value)}
                  />
                </div>
                <button
                  className="btn-add"
                  onClick={() => setShowAddModal(true)}
                >
                  <span>âž•</span>
                  Add New Member
                </button>
              </div>

              {loading ? (
                <div className="loading-container">
                  <div className="spinner"></div>
                </div>
              ) : (
                <div className="data-table-container">
                  {filteredMembers.length > 0 ? (
                    <table className="data-table">
                      <thead>
                        <tr>
                          <th>ID</th>
                          <th>Name</th>
                          <th>Email</th>
                          <th>Phone</th>
                          <th>Member Since</th>
                          <th>Actions</th>
                        </tr>
                      </thead>
                      <tbody>
                        {filteredMembers.map((member) => (
                          <tr key={member.id}>
                            <td>
                              <strong>#{member.id}</strong>
                            </td>
                            <td>
                              <strong>{member.name}</strong>
                            </td>
                            <td>{member.email}</td>
                            <td>{member.phone}</td>
                            <td>{formatDate(member.created_at)}</td>
                            <td>
                              <div className="table-actions">
                                <button
                                  className="btn-icon edit"
                                  onClick={() => openEditModal(member)}
                                  title="Edit Member"
                                >
                                  âœï¸
                                </button>
                                <button
                                  className="btn-icon delete"
                                  onClick={() => openDeleteModal(member)}
                                  title="Delete Member"
                                >
                                  ðŸ—‘ï¸
                                </button>
                              </div>
                            </td>
                          </tr>
                        ))}
                      </tbody>
                    </table>
                  ) : (
                    <div className="empty-state">
                      <div className="empty-state-icon">ðŸ‘¥</div>
                      <div className="empty-state-text">
                        {searchTerm
                          ? "No members found matching your search"
                          : "No members registered"}
                      </div>
                      <div className="empty-state-subtext">
                        {searchTerm
                          ? "Try a different search term"
                          : "Add your first member to get started"}
                      </div>
                    </div>
                  )}
                </div>
              )}
            </main>

            {/* Add Member Modal */}
            {showAddModal && (
              <div className="modal-overlay" onClick={closeModals}>
                <div
                  className="modal-container"
                  onClick={(e) => e.stopPropagation()}
                >
                  <div className="modal-header">
                    <h2 className="modal-title">Add New Member</h2>
                    <button className="btn-close" onClick={closeModals}>
                      âœ•
                    </button>
                  </div>
                  <form onSubmit={handleAddMember} className="modal-form">
                    <div className="form-group">
                      <label className="form-label">Full Name *</label>
                      <input
                        type="text"
                        className="form-input"
                        placeholder="Enter member's full name"
                        value={formData.name}
                        onChange={(e) =>
                          setFormData({ ...formData, name: e.target.value })
                        }
                        required
                      />
                    </div>
                    <div className="form-group">
                      <label className="form-label">Email Address *</label>
                      <input
                        type="email"
                        className="form-input"
                        placeholder="member@example.com"
                        value={formData.email}
                        onChange={(e) =>
                          setFormData({ ...formData, email: e.target.value })
                        }
                        required
                      />
                    </div>
                    <div className="form-group">
                      <label className="form-label">Phone Number *</label>
                      <input
                        type="tel"
                        className="form-input"
                        placeholder="+1 (555) 123-4567"
                        value={formData.phone}
                        onChange={(e) =>
                          setFormData({ ...formData, phone: e.target.value })
                        }
                        required
                      />
                    </div>
                    <div className="modal-actions">
                      <button
                        type="button"
                        className="btn-secondary"
                        onClick={closeModals}
                      >
                        Cancel
                      </button>
                      <button type="submit" className="btn-primary">
                        Add Member
                      </button>
                    </div>
                  </form>
                </div>
              </div>
            )}

            {/* Edit Member Modal */}
            {showEditModal && selectedMember && (
              <div className="modal-overlay" onClick={closeModals}>
                <div
                  className="modal-container"
                  onClick={(e) => e.stopPropagation()}
                >
                  <div className="modal-header">
                    <h2 className="modal-title">Edit Member</h2>
                    <button className="btn-close" onClick={closeModals}>
                      âœ•
                    </button>
                  </div>
                  <form onSubmit={handleEditMember} className="modal-form">
                    <div className="form-group">
                      <label className="form-label">Full Name *</label>
                      <input
                        type="text"
                        className="form-input"
                        placeholder="Enter member's full name"
                        value={formData.name}
                        onChange={(e) =>
                          setFormData({ ...formData, name: e.target.value })
                        }
                        required
                      />
                    </div>
                    <div className="form-group">
                      <label className="form-label">Email Address *</label>
                      <input
                        type="email"
                        className="form-input"
                        placeholder="member@example.com"
                        value={formData.email}
                        onChange={(e) =>
                          setFormData({ ...formData, email: e.target.value })
                        }
                        required
                      />
                    </div>
                    <div className="form-group">
                      <label className="form-label">Phone Number *</label>
                      <input
                        type="tel"
                        className="form-input"
                        placeholder="+1 (555) 123-4567"
                        value={formData.phone}
                        onChange={(e) =>
                          setFormData({ ...formData, phone: e.target.value })
                        }
                        required
                      />
                    </div>
                    <div className="modal-actions">
                      <button
                        type="button"
                        className="btn-secondary"
                        onClick={closeModals}
                      >
                        Cancel
                      </button>
                      <button type="submit" className="btn-primary">
                        Update Member
                      </button>
                    </div>
                  </form>
                </div>
              </div>
            )}

            {/* Delete Confirmation Modal */}
            {showDeleteModal && selectedMember && (
              <div className="modal-overlay" onClick={closeModals}>
                <div
                  className="modal-container confirm-dialog"
                  onClick={(e) => e.stopPropagation()}
                >
                  <div className="modal-header">
                    <h2 className="modal-title">Delete Member</h2>
                    <button className="btn-close" onClick={closeModals}>
                      âœ•
                    </button>
                  </div>
                  <div className="confirm-message">
                    Are you sure you want to delete this member? This action
                    cannot be undone.
                  </div>
                  <div className="confirm-detail">
                    <strong>Name:</strong> {selectedMember.name}
                    <br />
                    <strong>Email:</strong> {selectedMember.email}
                    <br />
                    <strong>Phone:</strong> {selectedMember.phone}
                  </div>
                  <div className="modal-actions">
                    <button className="btn-secondary" onClick={closeModals}>
                      Cancel
                    </button>
                    <button
                      className="btn-primary btn-danger"
                      onClick={handleDeleteMember}
                    >
                      Delete Member
                    </button>
                  </div>
                </div>
              </div>
            )}
          </div>
        );
      }

      // Books Management Component
      function BooksManagement({ onLogout, userName }) {
        const [books, setBooks] = useState([]);
        const [filteredBooks, setFilteredBooks] = useState([]);
        const [loading, setLoading] = useState(true);
        const [searchTerm, setSearchTerm] = useState("");
        const [showAddModal, setShowAddModal] = useState(false);
        const [showEditModal, setShowEditModal] = useState(false);
        const [showDeleteModal, setShowDeleteModal] = useState(false);
        const [selectedBook, setSelectedBook] = useState(null);
        const [formData, setFormData] = useState({
          title: "",
          author: "",
          isbn: "",
          quantity: "",
        });
        const [error, setError] = useState("");
        const [success, setSuccess] = useState("");

        useEffect(() => {
          loadBooks();
        }, []);

        useEffect(() => {
          // Filter books based on search term
          const filtered = books.filter(
            (book) =>
              book.title.toLowerCase().includes(searchTerm.toLowerCase()) ||
              book.author.toLowerCase().includes(searchTerm.toLowerCase()) ||
              book.isbn.toLowerCase().includes(searchTerm.toLowerCase()),
          );
          setFilteredBooks(filtered);
        }, [searchTerm, books]);

        const loadBooks = async () => {
          try {
            const token = localStorage.getItem("token");
            const data = await api.getBooks(token);
            setBooks(data);
            setFilteredBooks(data);
          } catch (error) {
            setError("Failed to load books");
          } finally {
            setLoading(false);
          }
        };

        const handleAddBook = async (e) => {
          e.preventDefault();
          setError("");
          setSuccess("");

          try {
            const token = localStorage.getItem("token");
            await api.addBook(token, {
              ...formData,
              quantity: parseInt(formData.quantity),
            });

            setSuccess("Book added successfully!");
            setShowAddModal(false);
            setFormData({ title: "", author: "", isbn: "", quantity: "" });
            loadBooks();

            setTimeout(() => setSuccess(""), 3000);
          } catch (error) {
            setError("Failed to add book");
          }
        };

        const handleEditBook = async (e) => {
          e.preventDefault();
          setError("");
          setSuccess("");

          try {
            const token = localStorage.getItem("token");
            await api.updateBook(token, selectedBook.id, {
              ...formData,
              quantity: parseInt(formData.quantity),
            });

            setSuccess("Book updated successfully!");
            setShowEditModal(false);
            setSelectedBook(null);
            setFormData({ title: "", author: "", isbn: "", quantity: "" });
            loadBooks();

            setTimeout(() => setSuccess(""), 3000);
          } catch (error) {
            setError("Failed to update book");
          }
        };

        const handleDeleteBook = async () => {
          setError("");
          setSuccess("");

          try {
            const token = localStorage.getItem("token");
            await api.deleteBook(token, selectedBook.id);

            setSuccess("Book deleted successfully!");
            setShowDeleteModal(false);
            setSelectedBook(null);
            loadBooks();

            setTimeout(() => setSuccess(""), 3000);
          } catch (error) {
            setError("Failed to delete book");
          }
        };

        const openEditModal = (book) => {
          setSelectedBook(book);
          setFormData({
            title: book.title,
            author: book.author,
            isbn: book.isbn,
            quantity: book.quantity.toString(),
          });
          setShowEditModal(true);
        };

        const openDeleteModal = (book) => {
          setSelectedBook(book);
          setShowDeleteModal(true);
        };

        const closeModals = () => {
          setShowAddModal(false);
          setShowEditModal(false);
          setShowDeleteModal(false);
          setSelectedBook(null);
          setFormData({ title: "", author: "", isbn: "", quantity: "" });
          setError("");
        };

        const formatDate = (dateString) => {
          if (!dateString) return "N/A";
          const date = new Date(dateString);
          return date.toLocaleDateString("en-US", {
            year: "numeric",
            month: "short",
            day: "numeric",
          });
        };

        return (
          <div className="app-container">
            <nav className="navbar">
              <div className="navbar-brand">Library System</div>
              <div className="navbar-menu">
                <a href="#dashboard" className="nav-link">
                  Dashboard
                </a>
                <a href="#books" className="nav-link active">
                  Books
                </a>
                <a href="#members" className="nav-link">
                  Members
                </a>
                <a href="#borrow" className="nav-link">
                  Borrow
                </a>
                <button className="logout-btn" onClick={onLogout}>
                  Logout
                </button>
              </div>
            </nav>

            <main className="main-content">
              <div className="page-header">
                <h1 className="page-title">Books Management</h1>
                <p className="page-description">
                  Manage your library's book collection
                </p>
              </div>

              {success && <div className="alert alert-success">{success}</div>}

              {error && <div className="alert alert-error">{error}</div>}

              <div className="page-actions">
                <div className="search-box">
                  <span className="search-icon">ðŸ”</span>
                  <input
                    type="text"
                    className="search-input"
                    placeholder="Search by title, author, or ISBN..."
                    value={searchTerm}
                    onChange={(e) => setSearchTerm(e.target.value)}
                  />
                </div>
                <button
                  className="btn-add"
                  onClick={() => setShowAddModal(true)}
                >
                  <span>âž•</span>
                  Add New Book
                </button>
              </div>

              {loading ? (
                <div className="loading-container">
                  <div className="spinner"></div>
                </div>
              ) : (
                <div className="data-table-container">
                  {filteredBooks.length > 0 ? (
                    <table className="data-table">
                      <thead>
                        <tr>
                          <th>ID</th>
                          <th>Title</th>
                          <th>Author</th>
                          <th>ISBN</th>
                          <th>Quantity</th>
                          <th>Available</th>
                          <th>Status</th>
                          <th>Added Date</th>
                          <th>Actions</th>
                        </tr>
                      </thead>
                      <tbody>
                        {filteredBooks.map((book) => (
                          <tr key={book.id}>
                            <td>
                              <strong>#{book.id}</strong>
                            </td>
                            <td>
                              <strong>{book.title}</strong>
                            </td>
                            <td>{book.author}</td>
                            <td>{book.isbn}</td>
                            <td>{book.quantity}</td>
                            <td>{book.available}</td>
                            <td>
                              <span
                                className={`status-badge ${book.available > 0 ? "available" : "unavailable"}`}
                              >
                                {book.available > 0
                                  ? "Available"
                                  : "Out of Stock"}
                              </span>
                            </td>
                            <td>{formatDate(book.created_at)}</td>
                            <td>
                              <div className="table-actions">
                                <button
                                  className="btn-icon edit"
                                  onClick={() => openEditModal(book)}
                                  title="Edit Book"
                                >
                                  âœï¸
                                </button>
                                <button
                                  className="btn-icon delete"
                                  onClick={() => openDeleteModal(book)}
                                  title="Delete Book"
                                >
                                  ðŸ—‘ï¸
                                </button>
                              </div>
                            </td>
                          </tr>
                        ))}
                      </tbody>
                    </table>
                  ) : (
                    <div className="empty-state">
                      <div className="empty-state-icon">ðŸ“š</div>
                      <div className="empty-state-text">
                        {searchTerm
                          ? "No books found matching your search"
                          : "No books in library"}
                      </div>
                      <div className="empty-state-subtext">
                        {searchTerm
                          ? "Try a different search term"
                          : "Add your first book to get started"}
                      </div>
                    </div>
                  )}
                </div>
              )}
            </main>

            {/* Add Book Modal */}
            {showAddModal && (
              <div className="modal-overlay" onClick={closeModals}>
                <div
                  className="modal-container"
                  onClick={(e) => e.stopPropagation()}
                >
                  <div className="modal-header">
                    <h2 className="modal-title">Add New Book</h2>
                    <button className="btn-close" onClick={closeModals}>
                      âœ•
                    </button>
                  </div>
                  <form onSubmit={handleAddBook} className="modal-form">
                    <div className="form-group">
                      <label className="form-label">Book Title *</label>
                      <input
                        type="text"
                        className="form-input"
                        placeholder="Enter book title"
                        value={formData.title}
                        onChange={(e) =>
                          setFormData({ ...formData, title: e.target.value })
                        }
                        required
                      />
                    </div>
                    <div className="form-group">
                      <label className="form-label">Author *</label>
                      <input
                        type="text"
                        className="form-input"
                        placeholder="Enter author name"
                        value={formData.author}
                        onChange={(e) =>
                          setFormData({ ...formData, author: e.target.value })
                        }
                        required
                      />
                    </div>
                    <div className="form-row">
                      <div className="form-group">
                        <label className="form-label">ISBN *</label>
                        <input
                          type="text"
                          className="form-input"
                          placeholder="ISBN number"
                          value={formData.isbn}
                          onChange={(e) =>
                            setFormData({ ...formData, isbn: e.target.value })
                          }
                          required
                        />
                      </div>
                      <div className="form-group">
                        <label className="form-label">Quantity *</label>
                        <input
                          type="number"
                          className="form-input"
                          placeholder="Number of copies"
                          value={formData.quantity}
                          onChange={(e) =>
                            setFormData({
                              ...formData,
                              quantity: e.target.value,
                            })
                          }
                          min="1"
                          required
                        />
                      </div>
                    </div>
                    <div className="modal-actions">
                      <button
                        type="button"
                        className="btn-secondary"
                        onClick={closeModals}
                      >
                        Cancel
                      </button>
                      <button type="submit" className="btn-primary">
                        Add Book
                      </button>
                    </div>
                  </form>
                </div>
              </div>
            )}

            {/* Edit Book Modal */}
            {showEditModal && selectedBook && (
              <div className="modal-overlay" onClick={closeModals}>
                <div
                  className="modal-container"
                  onClick={(e) => e.stopPropagation()}
                >
                  <div className="modal-header">
                    <h2 className="modal-title">Edit Book</h2>
                    <button className="btn-close" onClick={closeModals}>
                      âœ•
                    </button>
                  </div>
                  <form onSubmit={handleEditBook} className="modal-form">
                    <div className="form-group">
                      <label className="form-label">Book Title *</label>
                      <input
                        type="text"
                        className="form-input"
                        placeholder="Enter book title"
                        value={formData.title}
                        onChange={(e) =>
                          setFormData({ ...formData, title: e.target.value })
                        }
                        required
                      />
                    </div>
                    <div className="form-group">
                      <label className="form-label">Author *</label>
                      <input
                        type="text"
                        className="form-input"
                        placeholder="Enter author name"
                        value={formData.author}
                        onChange={(e) =>
                          setFormData({ ...formData, author: e.target.value })
                        }
                        required
                      />
                    </div>
                    <div className="form-row">
                      <div className="form-group">
                        <label className="form-label">ISBN *</label>
                        <input
                          type="text"
                          className="form-input"
                          placeholder="ISBN number"
                          value={formData.isbn}
                          onChange={(e) =>
                            setFormData({ ...formData, isbn: e.target.value })
                          }
                          required
                        />
                      </div>
                      <div className="form-group">
                        <label className="form-label">Quantity *</label>
                        <input
                          type="number"
                          className="form-input"
                          placeholder="Number of copies"
                          value={formData.quantity}
                          onChange={(e) =>
                            setFormData({
                              ...formData,
                              quantity: e.target.value,
                            })
                          }
                          min="1"
                          required
                        />
                      </div>
                    </div>
                    <div className="modal-actions">
                      <button
                        type="button"
                        className="btn-secondary"
                        onClick={closeModals}
                      >
                        Cancel
                      </button>
                      <button type="submit" className="btn-primary">
                        Update Book
                      </button>
                    </div>
                  </form>
                </div>
              </div>
            )}

            {/* Delete Confirmation Modal */}
            {showDeleteModal && selectedBook && (
              <div className="modal-overlay" onClick={closeModals}>
                <div
                  className="modal-container confirm-dialog"
                  onClick={(e) => e.stopPropagation()}
                >
                  <div className="modal-header">
                    <h2 className="modal-title">Delete Book</h2>
                    <button className="btn-close" onClick={closeModals}>
                      âœ•
                    </button>
                  </div>
                  <div className="confirm-message">
                    Are you sure you want to delete this book? This action
                    cannot be undone.
                  </div>
                  <div className="confirm-detail">
                    <strong>Book:</strong> {selectedBook.title}
                    <br />
                    <strong>Author:</strong> {selectedBook.author}
                    <br />
                    <strong>ISBN:</strong> {selectedBook.isbn}
                  </div>
                  <div className="modal-actions">
                    <button className="btn-secondary" onClick={closeModals}>
                      Cancel
                    </button>
                    <button
                      className="btn-primary btn-danger"
                      onClick={handleDeleteBook}
                    >
                      Delete Book
                    </button>
                  </div>
                </div>
              </div>
            )}
          </div>
        );
      }

      // Dashboard Component
      function Dashboard({ onLogout, userName }) {
        const [stats, setStats] = useState({
          totalBooks: 0,
          availableBooks: 0,
          totalMembers: 0,
          activeBorrows: 0,
        });
        const [recentBooks, setRecentBooks] = useState([]);
        const [recentMembers, setRecentMembers] = useState([]);
        const [loading, setLoading] = useState(true);

        useEffect(() => {
          loadDashboardData();
        }, []);

        const loadDashboardData = async () => {
          try {
            const token = localStorage.getItem("token");

            // Fetch books
            const books = await api.getBooks(token);

            // console.log(books);

            const totalBooks = books.length;

            const availableBooks = books.reduce((total, book) => {
              return total + book.available;
            }, 0);
            // const availableBooks = books.reduce(
            //   (sum, book) => sum + (book.available || 0),
            //   0,
            // );

            // Fetch members
            const members = await api.getMembers(token);

            const totalMembers = members.length;
            // Calculate active borrows (books that are checked out)
            const activeBorrows = books.reduce((sum, book) => {
              return sum + ((book.quantity || 0) - (book.available || 0));
            }, 0);

            setStats({
              totalBooks,
              availableBooks,
              totalMembers,
              activeBorrows,
            });

            // Get recent books (last 5)
            setRecentBooks(books.slice(-5).reverse());
            console.log(recentBooks);

            // Get recent members (last 5)
            setRecentMembers(members.slice(-5).reverse());
            console.log(recentMembers);
          } catch (error) {
            console.error("Error loading dashboard data:", error);
          } finally {
            setLoading(false);
          }
        };

        const formatDate = (dateString) => {
          if (!dateString) return "N/A";
          const date = new Date(dateString);
          return date.toLocaleDateString("en-US", {
            year: "numeric",
            month: "short",
            day: "numeric",
          });
        };

        if (loading) {
          return (
            <div className="app-container">
              <nav className="navbar">
                <div className="navbar-brand">Library System</div>
                <div className="navbar-menu">
                  <a href="#dashboard" className="nav-link active">
                    Dashboard
                  </a>
                  <a href="#books" className="nav-link">
                    Books
                  </a>
                  <a href="#members" className="nav-link">
                    Members
                  </a>
                  <a href="#borrow" className="nav-link">
                    Borrow
                  </a>
                  <button className="logout-btn" onClick={onLogout}>
                    Logout
                  </button>
                </div>
              </nav>
              <main className="main-content">
                <div className="loading-container">
                  <div className="spinner"></div>
                </div>
              </main>
            </div>
          );
        }

        return (
          <div className="app-container">
            <nav className="navbar">
              <div className="navbar-brand">Library System</div>
              <div className="navbar-menu">
                <a href="#" className="nav-link active">
                  Dashboard
                </a>
                <a href="#books" className="nav-link">
                  Books
                </a>
                <a href="#members" className="nav-link">
                  Members
                </a>
                <a href="#borrow" className="nav-link">
                  Borrow
                </a>
                <button className="logout-btn" onClick={onLogout}>
                  Logout
                </button>
              </div>
            </nav>
            <main className="main-content">
              <div className="page-header">
                <h1 className="page-title">Dashboard</h1>
                <p className="page-description">
                  Welcome back, {userName}! Here's your library overview.
                </p>
              </div>

              {/* Statistics Cards */}
              <div className="stats-grid">
                <div className="stat-card">
                  <div className="stat-icon">ðŸ“š</div>
                  <div className="stat-label">Total Books</div>
                  <div className="stat-value">{stats.totalBooks}</div>
                  <div className="stat-description">In library collection</div>
                </div>

                <div className="stat-card">
                  <div className="stat-icon">âœ…</div>
                  <div className="stat-label">Available Copies</div>
                  <div className="stat-value">{stats.availableBooks}</div>
                  <div className="stat-description">Ready to be borrowed</div>
                </div>

                <div className="stat-card">
                  <div className="stat-icon">ðŸ‘¥</div>
                  <div className="stat-label">Total Members</div>
                  <div className="stat-value">{stats.totalMembers}</div>
                  <div className="stat-description">
                    Registered library members
                  </div>
                </div>

                <div className="stat-card">
                  <div className="stat-icon">ðŸ“–</div>
                  <div className="stat-label">Active Borrows</div>
                  <div className="stat-value">{stats.activeBorrows}</div>
                  <div className="stat-description">
                    Books currently checked out
                  </div>
                </div>
              </div>

              {/* Quick Actions */}
              <div className="quick-actions">
                <button
                  className="quick-action-btn"
                  onClick={() => (window.location.hash = "#books")}
                >
                  <span className="quick-action-icon">âž•</span>
                  Add New Book
                </button>
                <button
                  className="quick-action-btn"
                  onClick={() => (window.location.hash = "#members")}
                >
                  <span className="quick-action-icon">ðŸ‘¤</span>
                  Add New Member
                </button>
                <button
                  className="quick-action-btn"
                  onClick={() => (window.location.hash = "#borrow")}
                >
                  <span className="quick-action-icon">ðŸ“¤</span>
                  Issue Book
                </button>
                <button
                  className="quick-action-btn"
                  onClick={() => (window.location.hash = "#borrow")}
                >
                  <span className="quick-action-icon">ðŸ“¥</span>
                  Return Book
                </button>
              </div>

              {/* Recent Books */}
              <div className="dashboard-section">
                <div className="section-header">
                  <h2 className="section-title">Recent Books</h2>
                  <a href="#" className="section-link">
                    View All â†’
                  </a>
                </div>
                {recentBooks.length > 0 ? (
                  <table className="activity-table">
                    <thead>
                      <tr>
                        <th>Title</th>
                        <th>Author</th>
                        <th>ISBN</th>
                        <th>Available</th>
                        <th>Status</th>
                        <th>Added Date</th>
                      </tr>
                    </thead>
                    <tbody>
                      {recentBooks.map((book) => (
                        <tr key={book.id}>
                          <td>
                            <strong>{book.title}</strong>
                          </td>
                          <td>{book.author}</td>
                          <td>{book.isbn}</td>
                          <td>
                            {book.available} / {book.quantity}
                          </td>
                          <td>
                            <span
                              className={`status-badge ${book.available > 0 ? "available" : "unavailable"}`}
                            >
                              {book.available > 0 ? "Available" : "Unavailable"}
                            </span>
                          </td>
                          <td>{formatDate(book.created_at)}</td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                ) : (
                  <div className="empty-state">
                    <div className="empty-state-icon">ðŸ“š</div>
                    <div className="empty-state-text">No books yet</div>
                    <div className="empty-state-subtext">
                      Start by adding your first book to the library
                    </div>
                  </div>
                )}
              </div>

              {/* Recent Members */}
              <div className="dashboard-section">
                <div className="section-header">
                  <h2 className="section-title">Recent Members</h2>
                  <a href="#" className="section-link">
                    View All â†’
                  </a>
                </div>
                {recentMembers.length > 0 ? (
                  <table className="activity-table">
                    <thead>
                      <tr>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Phone</th>
                        <th>Joined Date</th>
                      </tr>
                    </thead>
                    <tbody>
                      {recentMembers.map((member) => (
                        <tr key={member.id}>
                          <td>
                            <strong>{member.name}</strong>
                          </td>
                          <td>{member.email}</td>
                          <td>{member.phone}</td>
                          <td>{formatDate(member.created_at)}</td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                ) : (
                  <div className="empty-state">
                    <div className="empty-state-icon">ðŸ‘¥</div>
                    <div className="empty-state-text">No members yet</div>
                    <div className="empty-state-subtext">
                      Register your first library member to get started
                    </div>
                  </div>
                )}
              </div>
            </main>
          </div>
        );
      }

      // Main App Component
      function App() {
        const [isAuthenticated, setIsAuthenticated] = useState(false);
        const [showRegister, setShowRegister] = useState(false);
        const [userName, setUserName] = useState("");
        const [loading, setLoading] = useState(true);
        const [currentPage, setCurrentPage] = useState("dashboard");

        useEffect(() => {
          // Check if user is already logged in
          const token = localStorage.getItem("token");
          const name = localStorage.getItem("userName");
          if (token) {
            setIsAuthenticated(true);
            setUserName(name || "User");
          }
          setLoading(false);

          // Handle navigation
          const handleHashChange = () => {
            const hash = window.location.hash.slice(1);
            if (hash) {
              setCurrentPage(hash);
            }
          };

          window.addEventListener("hashchange", handleHashChange);
          handleHashChange();

          return () =>
            window.removeEventListener("hashchange", handleHashChange);
        }, []);

        const handleLogin = (token) => {
          setIsAuthenticated(true);
          const name = localStorage.getItem("userName");
          setUserName(name || "User");
        };

        const handleLogout = () => {
          localStorage.removeItem("token");
          localStorage.removeItem("userName");
          setIsAuthenticated(false);
          setUserName("");
          setCurrentPage("dashboard");
          window.location.hash = "";
        };

        if (loading) {
          return (
            <div className="loading-container">
              <div className="spinner"></div>
            </div>
          );
        }

        if (isAuthenticated) {
          // Route to different pages based on currentPage
          if (currentPage === "books") {
            return (
              <BooksManagement onLogout={handleLogout} userName={userName} />
            );
          }

          if (currentPage === "members") {
            return (
              <MembersManagement onLogout={handleLogout} userName={userName} />
            );
          }

          if (currentPage === "borrow") {
            return <BorrowSystem onLogout={handleLogout} userName={userName} />;
          }

          return <Dashboard onLogout={handleLogout} userName={userName} />;
        }

        if (showRegister) {
          return <Register onSwitchToLogin={() => setShowRegister(false)} />;
        }

        return (
          <Login
            onLogin={handleLogin}
            onSwitchToRegister={() => setShowRegister(true)}
          />
        );
      }

      // Render the app
      ReactDOM.render(<App />, document.getElementById("root"));
    </script>
  </body>
</html>
